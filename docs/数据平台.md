### Install dc

```shell
sudo mkdir /etc/mysql.d/init-sql /data/mysql -p
sudo touch /etc/mysql.d/docker-compose.yaml
sudo chmod -R 777 /data/mysql /etc/mysql.d
sudo wget https://raw.fastgit.org/mmh-xu/docker-compose/master/Yearning/docker/etc/mysql/my.cnf -o /etc/mysql.d/
sudo wget https://raw.fastgit.org/mmh-xu/docker-compose/master/Yearning/init-sql/install.sql -o /etc/mysql.d/init-sql/
sudo cat > /etc/mysql.d/docker-compose.yaml <<EOF
version: '3'
services:
  mysql:
    image: mysql:5.7
    volumes:
      - /etc/mysql.d/:/etc/mysql/conf.d/
      - /etc/mysql.d/init-sql/:/docker-entrypoint-initdb.d/
      - /data/mysql:/var/lib/mysql/
    restart: always
    ports:
      - 3306:3306
    environment:
      MYSQL_ROOT_PASSWORD: gmt
      MYSQL_DATABASE: yearning
      MYSQL_USER: gmt
      MYSQL_PASSWORD: gmt
  soar-web:
    image: becivells/soar-web
    container_name: soar-web
    restart: always
    ports:
      - 5077:5077
    networks:
      - dc
  yearning:
    image: registry.cn-hangzhou.aliyuncs.com/cookie/yearning:latest
    container_name: yearning
    restart: always
    depends_on: 
      - mysql
    ports:
      - 5080:8000
    environment:
      HOST: localhost
      MYSQL_PASSWORD: gmt
      MYSQL_USER: gmt
      MYSQL_ADDR: mysql
    networks:
      - dc
networks:
  dc:
    driver: bridge
EOF
docker-compose -f /etc/mysql.d/docker-compose.yaml up -d
```

```shell
sudo mkdir /etc/mongo.d /data/mongo/db /data/mongo/log -p
sudo touch /etc/mongo.d/docker-compose.yaml
sudo chmod -R 777 /data/mongo /etc/mongo.d
sudo cat > /etc/mongo.d/docker-compose.yaml <<EOF
version: '3'
services:
  mongo:
    image: mongo:4.2
    ports:
      - 27017:27017
    restart: always
    tty: true
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: admin123abc123
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /data/mongo/db:/data/db
      - /data/mongo/log:/data/log
    command:
      - /bin/bash
      - -c
      - mongod --port 27017 --bind_ip_all --auth --dbpath "/data/db"   --logpath "/data/log/db.log" 
    networks:
      - dc
  mongo-express:
    links:
      - mongo
    image: mongo-express
    restart: always
    ports:
      - 27018:8081
    environment:
      ME_CONFIG_OPTIONS_EDITORTHEME: 3024-night
      ME_CONFIG_BASICAUTH_USERNAME: admin
      ME_CONFIG_BASICAUTH_PASSWORD: admin123abc123
      ME_CONFIG_MONGODB_ADMINUSERNAME: admin
      ME_CONFIG_MONGODB_ADMINPASSWORD: admin123abc123
    depends_on: 
      - mongo
    networks:
      - dc
  mysql:
    image: mysql:5.7
    volumes:
      - /etc/mysql.d/:/etc/mysql/conf.d/
      - /etc/mysql.d/init-sql/:/docker-entrypoint-initdb.d/
      - /data/mysql:/var/lib/mysql/
    restart: always
    ports:
      - 3306:3306
    environment:
      MYSQL_ROOT_PASSWORD: gmt
      MYSQL_DATABASE: yearning
      MYSQL_USER: gmt
      MYSQL_PASSWORD: gmt
  soar-web:
    image: becivells/soar-web
    container_name: soar-web
    restart: always
    ports:
      - 5077:5077
    networks:
      - dc
  yearning:
    image: registry.cn-hangzhou.aliyuncs.com/cookie/yearning:latest
    container_name: yearning
    restart: always
    depends_on: 
      - mysql
    ports:
      - 5080:8000
    environment:
      HOST: localhost
      MYSQL_PASSWORD: gmt
      MYSQL_USER: gmt
      MYSQL_ADDR: mysql
    networks:
      - dc
networks:
  dc:
    driver: bridge
EOF
docker-compose -f /etc/mongo.d/docker-compose.yaml up -d
```

```shell
sudo mkdir /etc/redis.d /data/redis/db /data/redis/log -p
sudo touch /etc/redis.d/docker-compose.yaml /etc/redis.d/redis-cluster.tmpl
sudo chmod -R 777 /data/redis /etc/redis.d
sudo cat > /etc/redis.d/redis-cluster.tmpl <<EOF
port ${PORT}
requirepass 123456
masterauth 123456
protected-mode no
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 192.168.1.10
cluster-announce-port ${PORT}
cluster-announce-bus-port 1${PORT}
appendonly yes
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

logfile /data/redis.log
EOF
for port in `seq 7001 7006`; do \
  sudo mkdir -p /etc/redis.d/${port}
  sudo PORT=${port} envsubst < /etc/redis.d/redis-cluster.tmpl > /etc/redis.d/${port}/redis.conf
  sudo mkdir -p /data/redis/${port}/data
  sudo chmod -R 777 /etc/redis.d/${port} /data/redis/${port}/data;
done
sudo cat > /etc/redis.d/docker-compose.yaml <<EOF
version: '3'
services:
  redis7001:
    image: redis:6
    container_name: redis7001
    command:
      ["redis-server", "/usr/local/etc/redis/redis.conf"]
    volumes:
      - /etc/redis.d/7001/redis.conf:/usr/local/etc/redis/redis.conf
      - /data/redis/7001/data:/data
    ports:
      - 7001:7001
      - 17001:17001
    environment:
      - TZ=Asia/Shanghai
    logging:
      options:
        max-size: '100m'
        max-file: '10'

  redis7002:
    image: redis:6
    container_name: redis7002
    command:
      ["redis-server", "/usr/local/etc/redis/redis.conf"]
    volumes:
      - /etc/redis.d/7002/redis.conf:/usr/local/etc/redis/redis.conf
      - /data/redis/7002/data:/data
    ports:
      - 7002:7002
      - 17002:17002
    environment:
      - TZ=Asia/Shanghai
    logging:
      options:
        max-size: '100m'
        max-file: '10'

  redis7003:
    image: redis:6
    container_name: redis7003
    command:
      ["redis-server", "/usr/local/etc/redis/redis.conf"]
    volumes:
      - /etc/redis.d/7003/redis.conf:/usr/local/etc/redis/redis.conf
      - /data/redis/7003/data:/data
    ports:
      - 7003:7003
      - 17003:17003
    environment:
      - TZ=Asia/Shanghai
    logging:
      options:
        max-size: '100m'
        max-file: '10'

  redis7004:
    image: redis:6
    container_name: redis7004
    command:
      ["redis-server", "/usr/local/etc/redis/redis.conf"]
    volumes:
      - /etc/redis.d/7004/redis.conf:/usr/local/etc/redis/redis.conf
      - /data/redis/7004/data:/data
    ports:
      - 7004:7004
      - 17004:17004
    environment:
      - TZ=Asia/Shanghai
    logging:
      options:
        max-size: '100m'
        max-file: '10'

  redis7005:
    image: redis:6
    container_name: redis7005
    command:
      ["redis-server", "/usr/local/etc/redis/redis.conf"]
    volumes:
      - /etc/redis.d/7005/redis.conf:/usr/local/etc/redis/redis.conf
      - /data/redis/7005/data:/data
    ports:
      - 7005:7005
      - 17005:17005
    environment:
      - TZ=Asia/Shanghai
    logging:
      options:
        max-size: '100m'
        max-file: '10'

  redis7006:
    image: redis:6
    container_name: redis7006
    command:
      ["redis-server", "/usr/local/etc/redis/redis.conf"]
    volumes:
      - /etc/redis.d/7006/redis.conf:/usr/local/etc/redis/redis.conf
      - /data/redis/7006/data:/data
    ports:
      - 7006:7006
      - 17006:17006
    environment:
      - TZ=Asia/Shanghai
    logging:
      options:
        max-size: '100m'
        max-file: '10'
networks:
  dc:
    driver: bridge
EOF
docker-compose -f /etc/redis.d/docker-compose.yaml up -d
docker exec -it redis7001 redis-cli -p 7001 -a 123456 --cluster create 192.168.1.10:7001 192.168.1.10:7002 192.168.1.10:7003 192.168.1.10:7004 192.168.1.10:7005 192.168.1.10:7006 --cluster-replicas 1
```
